Front end still work in progress.
Back end might use some refactoring.
